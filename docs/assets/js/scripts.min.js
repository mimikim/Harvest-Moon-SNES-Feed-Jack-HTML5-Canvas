"use strict";var _createClass=function(){function n(n,e){for(var a=0;a<e.length;a++){var t=e[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}return function(e,a,t){return a&&n(e.prototype,a),t&&n(e,t),e}}();function _classCallCheck(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var App=function(){function n(){_classCallCheck(this,n),new View,this.setVars(),this.setBackgroundImg(),this.startAnimation(),this.stopAnimation()}return _createClass(n,[{key:"setVars",value:function(){this.btnStart=document.getElementById("js-start"),window.hmcanvas=window.hmcanvas||{},window.hmcanvas.requestID=void 0,window.hmcanvas.frameIndex=0,window.hmcanvas.canvas=document.getElementById("js-canvas"),window.hmcanvas.ctx=window.hmcanvas.canvas.getContext("2d"),window.hmcanvas.food=new Food,window.hmcanvas.jack=new Jack}},{key:"setBackgroundImg",value:function(){document.getElementById("js-background-form").addEventListener("submit",function(n){n.preventDefault();var e=document.getElementById("js-background-select"),a=e.options[e.selectedIndex].value;document.getElementById("js-canvas-container").style.backgroundImage="url('"+a+"')"})}},{key:"startAnimation",value:function(){var n=this;document.getElementById("js-food-form").addEventListener("submit",function(e){e.preventDefault(),n.btnStart.value="Change Food Item",window.hmcanvas.frameIndex=0;var a=document.getElementById("js-food-select");window.hmcanvas.food.getData(a),window.hmcanvas.requestID||window.hmcanvas.jack.loop()})}},{key:"stopAnimation",value:function(){var n=this;document.getElementById("js-stop").addEventListener("click",function(){window.hmcanvas.requestID&&(window.cancelAnimationFrame(window.hmcanvas.requestID),window.hmcanvas.requestID=void 0),n.btnStart.value="Start Animation",window.hmcanvas.frameIndex=0,Jack.clearCanvas(),window.hmcanvas.jack.reset()})}}]),n}();_createClass=function(){function n(n,e){for(var a=0;a<e.length;a++){var t=e[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}return function(e,a,t){return a&&n(e.prototype,a),t&&n(e,t),e}}();function _classCallCheck(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var Food=function(){function n(){_classCallCheck(this,n),this.food=new Image,this.food.xpos=160,this.food.ypos=240}return _createClass(n,[{key:"getData",value:function(n){var e=n.options[n.selectedIndex];this.food.src=e.value,this.food.xpos=e.getAttribute("data-x-value")||160,this.food.ypos=e.getAttribute("data-y-value")||240}},{key:"draw",value:function(){window.hmcanvas.ctx.drawImage(this.food,this.food.xpos,this.food.ypos)}}]),n}();_createClass=function(){function n(n,e){for(var a=0;a<e.length;a++){var t=e[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}return function(e,a,t){return a&&n(e.prototype,a),t&&n(e,t),e}}();function _classCallCheck(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var Jack=function(){function n(){_classCallCheck(this,n),this.setVars(),this.reset()}return _createClass(n,[{key:"setVars",value:function(){this.jackImage=new Image,this.jackImage.src="./assets/images/jack-eating.png",this.jackImage.xpos=200,this.jackImage.ypos=240,this.tickCount=0,this.ticksPerFrame=15,this.numberOfFrames=11}},{key:"loop",value:function(){var e=this;if(this.tickCount+=1,this.tickCount>this.ticksPerFrame){this.tickCount=0;var a=window.hmcanvas.frameIndex<this.numberOfFrames-1;window.hmcanvas.frameIndex=a?window.hmcanvas.frameIndex+=1:0,n.clearCanvas(),this.renderFrame(window.hmcanvas.frameIndex),window.hmcanvas.frameIndex<3&&window.hmcanvas.food.draw()}window.hmcanvas.requestID=window.requestAnimationFrame(function(){return e.loop()})}},{key:"renderFrame",value:function(n){window.hmcanvas.ctx.drawImage(this.jackImage,1045*n/11,0,95,120,this.jackImage.xpos,this.jackImage.ypos,95,120)}},{key:"reset",value:function(){var n=this,e=new Image;e.src="./assets/images/jack-standing.png",e.onload=function(){window.hmcanvas.ctx.drawImage(e,n.jackImage.xpos+5,n.jackImage.ypos+5)}}}],[{key:"clearCanvas",value:function(){window.hmcanvas.ctx.clearRect(0,0,window.hmcanvas.canvas.width,window.hmcanvas.canvas.height)}}]),n}();function _classCallCheck(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var View=function n(){_classCallCheck(this,n),new Promise(function(n){var e=new XMLHttpRequest;e.onload=function(){4===this.readyState&&200===this.status&&n(e.responseText)},e.open("GET","../sprites.json",!0),e.send(null)}).then(function(n){JSON.parse(n).forEach(function(n){var e=n.name,a=n.url,t=n["x-pos"],o=n["y-pos"];document.getElementById("js-food-select").innerHTML+='<option value="'+a+'" data-x-value="'+t+'" data-y-value="'+o+'">'+e+"</option>\n"})})};window.onload=(function(){for(var n=0,e=["ms","moz","webkit","o"],a=0;a<e.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[e[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[a]+"CancelAnimationFrame"]||window[e[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,a){var t=(new Date).getTime(),o=Math.max(0,16-(t-n)),i=window.setTimeout(function(){e(t+o)},o);return n=t+o,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})}(),void new App);