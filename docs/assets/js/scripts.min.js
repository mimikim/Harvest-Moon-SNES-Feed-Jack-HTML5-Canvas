"use strict";var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var App=function(){function e(){_classCallCheck(this,e),new View,this.setVars(),this.setBackgroundImg(),this.startAnimation(),this.stopAnimation()}return _createClass(e,[{key:"setVars",value:function(){this.bgSelector=document.getElementById("background-selector"),this.foodSelector=document.getElementById("food-selector"),this.btnStart=document.getElementById("start-animation"),this.btnStop=document.getElementById("stop-animation"),window.hmcanvas={},window.hmcanvas.requestID=void 0,window.hmcanvas.frameIndex=0,window.hmcanvas.canvas=document.getElementById("eating"),window.hmcanvas.ctx=window.hmcanvas.canvas.getContext("2d"),window.hmcanvas.food=new Food,window.hmcanvas.jack=new Jack}},{key:"setBackgroundImg",value:function(){this.bgSelector.addEventListener("submit",function(e){e.preventDefault();var n=document.getElementById("background-select"),t=document.getElementById("canvas-container"),a=n.options[n.selectedIndex].value;t.style.backgroundImage="url("+a+")"})}},{key:"startAnimation",value:function(){var e=this;this.foodSelector.addEventListener("submit",function(n){n.preventDefault(),e.btnStart.value="Change Food Item",window.hmcanvas.frameIndex=0,window.hmcanvas.food.getData(),window.hmcanvas.requestID||window.hmcanvas.jack.loop()})}},{key:"stopAnimation",value:function(){var e=this;this.btnStop.addEventListener("click",function(){window.hmcanvas.requestID&&(window.cancelAnimationFrame(window.hmcanvas.requestID),window.hmcanvas.requestID=void 0),e.btnStart.value="Start Animation",window.hmcanvas.frameIndex=0,Jack.clearCanvas(),window.hmcanvas.jack.reset()})}}]),e}();_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var Food=function(){function e(){_classCallCheck(this,e),this.setVars()}return _createClass(e,[{key:"setVars",value:function(){this.food=new Image,this.food.xpos=160,this.food.ypos=240,this.selector=document.getElementById("food-select")}},{key:"getData",value:function(){var e=this.selector.options[this.selector.selectedIndex];this.food.src=e.value,this.food.xpos=e.getAttribute("data-x-value")||160,this.food.ypos=e.getAttribute("data-y-value")||240}},{key:"draw",value:function(){window.hmcanvas.ctx.drawImage(this.food,this.food.xpos,this.food.ypos)}}]),e}();_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var Jack=function(){function e(){_classCallCheck(this,e),this.setVars(),this.reset()}return _createClass(e,[{key:"setVars",value:function(){this.jackImage=new Image,this.jackImage.src="./assets/images/jack-eating.png",this.jackImage.xpos=200,this.jackImage.ypos=240,this.tickCount=0,this.ticksPerFrame=15,this.numberOfFrames=11}},{key:"loop",value:function(){var n=this;if(this.tickCount+=1,this.tickCount>this.ticksPerFrame){this.tickCount=0;var t=window.hmcanvas.frameIndex<this.numberOfFrames-1;window.hmcanvas.frameIndex=t?window.hmcanvas.frameIndex+=1:0,e.clearCanvas(),this.renderFrame(window.hmcanvas.frameIndex),window.hmcanvas.frameIndex<3&&window.hmcanvas.food.draw()}window.hmcanvas.requestID=window.requestAnimationFrame(function(){return n.loop()})}},{key:"renderFrame",value:function(e){window.hmcanvas.ctx.drawImage(this.jackImage,1045*e/11,0,95,120,this.jackImage.xpos,this.jackImage.ypos,95,120)}},{key:"reset",value:function(){var e=this,n=new Image;n.src="./assets/images/jack-standing.png",n.onload=function(){window.hmcanvas.ctx.drawImage(n,e.jackImage.xpos+5,e.jackImage.ypos+5)}}}],[{key:"clearCanvas",value:function(){window.hmcanvas.ctx.clearRect(0,0,window.hmcanvas.canvas.width,window.hmcanvas.canvas.height)}}]),e}();_createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var View=function(){function e(){var n=this;_classCallCheck(this,e),this.foodSelector=document.getElementById("food-select"),this.options="",new Promise(function(e){var n=new XMLHttpRequest;n.onload=function(){4===this.readyState&&200===this.status&&e(n.responseText)},n.open("GET","../sprites.json",!0),n.send(null)}).then(function(e){n.setHTML(JSON.parse(e)),n.foodSelector.innerHTML=n.options})}return _createClass(e,[{key:"setHTML",value:function(e){var n=this;e.forEach(function(e){var t=e.name,a=e.url,o=e["x-pos"],i=e["y-pos"];n.options+='<option value="'+a+'" data-x-value="'+o+'" data-y-value="'+i+'">'+t+"</option>\n"})}}]),e}();window.onload=(function(){for(var e=0,n=["ms","moz","webkit","o"],t=0;t<n.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[n[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[t]+"CancelAnimationFrame"]||window[n[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n,t){var a=(new Date).getTime(),o=Math.max(0,16-(a-e)),i=window.setTimeout(function(){n(a+o)},o);return e=a+o,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),void new App);